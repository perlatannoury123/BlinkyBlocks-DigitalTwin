#include <user_code.h>
#include <microphone.h>
#include <speaker.h>
#include <light.h>
#include <abstraction.h>
#include <debug_messages.h>
#include <layer3_generic.h>
#include <stdint.h>
#include <string.h>


uint8_t counter;
// =========================
// Initialization
// =========================
void BBinit() {
    setColor(GREEN);  // Idle / Ready
    counter = 0;

}

// =========================
// Main loop
// =========================
void BBloop() {
    counter++; // increment tick number

    // --- Prepare a simple numeric message ---
    uint8_t msg[1];
    msg[0] = counter;  // just send one byte (the counter)

    // --- Turn red while sending ---
    setColor(RED);
    if(getId() == 1){
    // --- Send message to parent/root ---
    	send_debug_message(msg, sizeof(msg));
    	sleep_sec(1);

    }
    // --- Wait briefly for ack/unack ---
    sleep_sec(1);

}

// =========================
// When a debug message is received
// =========================
uint8_t process_standard_packet(L3_packet *packet) { return 0; }
void process_standard_ack(L3_packet *p) {}
void process_standard_unack(L3_packet *p) {}
